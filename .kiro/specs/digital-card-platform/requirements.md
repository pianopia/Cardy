# 要件定義書

## 概要

ポケモンカードのような3D表示機能を持つデジタルカード管理プラットフォーム。ユーザーがオリジナルカードを作成し、販売・配布できる機能を提供し、希少価値を持たせることで収集価値のあるデジタルアセットとして管理する。

## 要件

### 要件 1: 3Dカード表示機能

**ユーザーストーリー:** カード収集者として、カードの表と裏を3D表示で確認できるようにしたい。これにより、実物のカードのような体験を得られる。

#### 受入基準

1. WHEN ユーザーがカードを選択 THEN システムは3D表示でカードを表示する
2. WHEN ユーザーがカードをドラッグまたはスワイプ THEN システムはカードを回転させて裏面を表示する
3. WHEN カードが3D表示されている THEN システムは滑らかなアニメーションでカードの回転を実行する
4. IF カードに画像が設定されている THEN システムは表面と裏面に適切に画像を表示する

### 要件 2: カード作成機能

**ユーザーストーリー:** クリエイターとして、オリジナルのカードを作成し、画像をアップロードして独自のデザインを作りたい。

#### 受入基準

1. WHEN ユーザーがカード作成画面にアクセス THEN システムはカード作成フォームを表示する
2. WHEN ユーザーがカード名、説明、画像をアップロード THEN システムはカードデータを保存する
3. WHEN ユーザーが表面と裏面の画像を設定 THEN システムは両面の画像を適切に保存する
4. WHEN カード作成が完了 THEN システムは作成されたカードのプレビューを3D表示で提供する
5. IF 画像ファイルが対応形式でない THEN システムはエラーメッセージを表示する

### 要件 3: カード販売・配布機能

**ユーザーストーリー:** クリエイターとして、作成したカードを他のユーザーに販売または配布したい。

#### 受入基準

1. WHEN クリエイターがカードを販売設定 THEN システムは価格と配布数を設定できる
2. WHEN クリエイターが配布数を制限 THEN システムは設定された数量以上の販売を防ぐ
3. WHEN ユーザーがカードを購入 THEN システムは決済処理を実行し、カードの所有権を移転する
4. WHEN 配布数が上限に達した THEN システムはそのカードの販売を停止する
5. IF 購入者の決済が失敗した THEN システムは購入をキャンセルし、在庫を元に戻す

### 要件 4: ユーザー所有権管理

**ユーザーストーリー:** コレクターとして、自分が所有するカードを管理し、コレクションを確認したい。

#### 受入基準

1. WHEN ユーザーがマイコレクション画面にアクセス THEN システムは所有するカードの一覧を表示する
2. WHEN ユーザーがカードを購入 THEN システムはそのカードをユーザーのコレクションに追加する
3. WHEN ユーザーが所有カードを選択 THEN システムは3D表示でカードの詳細を表示する
4. WHEN システムがカードの所有権を記録 THEN システムは改ざん不可能な形で所有権を管理する

### 要件 5: 希少価値システム

**ユーザーストーリー:** コレクターとして、限定カードの希少価値を理解し、価値のあるコレクションを構築したい。

#### 受入基準

1. WHEN カードが作成される THEN システムは配布数の上限を設定できる
2. WHEN カードの残り配布数が表示される THEN システムは正確な残数を表示する
3. WHEN 限定カードが完売 THEN システムは「完売」ステータスを表示する
4. WHEN ユーザーがカード詳細を確認 THEN システムは総発行数と現在の所有者数を表示する
5. IF カードが希少（発行数が少ない） THEN システムは希少度を視覚的に表示する

### 要件 6: カードセット機能

**ユーザーストーリー:** クリエイターとして、関連するカードをセットとしてグループ化し、セット単位で販売したい。

#### 受入基準

1. WHEN クリエイターがカードセットを作成 THEN システムは複数のカードをグループ化できる
2. WHEN セットが作成される THEN システムはセット名、説明、セット価格を設定できる
3. WHEN ユーザーがセットを購入 THEN システムはセット内の全カードの所有権を移転する
4. WHEN セットの配布数が制限される THEN システムはセット単位で在庫を管理する
5. WHEN ユーザーがセットを表示 THEN システムはセット内のカードを一覧表示し、3D表示で確認できる
6. IF セット内の一部カードが売り切れ THEN システムはセット全体を販売停止にする

### 要件 7: マルチロールユーザー機能

**ユーザーストーリー:** ユーザーとして、同一アカウントでクリエイター（出品者）とコレクター（購入者）の両方の役割を果たしたい。

#### 受入基準

1. WHEN ユーザーがアカウントを作成 THEN システムは自動的にクリエイターとコレクターの両方の権限を付与する
2. WHEN ユーザーがダッシュボードにアクセス THEN システムは「作成したカード」と「所有するカード」の両方を表示する
3. WHEN ユーザーが自分の作成したカードを購入 THEN システムは購入を許可し、所有権を記録する
4. WHEN ユーザーが販売統計を確認 THEN システムはクリエイターとしての売上情報を表示する
5. WHEN ユーザーがコレクション統計を確認 THEN システムはコレクターとしての所有カード情報を表示する

### 要件 8: ユーザー認証・管理

**ユーザーストーリー:** プラットフォーム利用者として、安全にアカウントを管理し、自分のデータを保護したい。

#### 受入基準

1. WHEN 新規ユーザーが登録 THEN システムはメール認証を要求する
2. WHEN ユーザーがログイン THEN システムは認証情報を検証し、セッションを開始する
3. WHEN ユーザーがプロフィールを更新 THEN システムは変更を保存し、確認メッセージを表示する
4. WHEN ユーザーがパスワードを変更 THEN システムは現在のパスワードの確認を要求する
5. IF 不正なログイン試行が検出された THEN システムはアカウントを一時的にロックする